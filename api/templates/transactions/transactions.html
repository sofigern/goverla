{% extends "base.html" %}

{% block content %}

<h1>Пошук трансакцій за кодом платника</h1>


<form method="GET">
    <div class="row">


        <div class="col">
            <label for="payers_edrpous">Код платника:</label>
            <input type="text" id="payers_edrpous" name="payers_edrpous" class="form-control"
                   value="{{ request_params.payers_edrpous|default:'' }}" placeholder="00035323">
        </div>
        <div class="col">
            <label for="startdate">Дата з:</label>
            <input type="date" id="startdate" name="startdate" class="form-control"
                   value="{{ request_params.startdate|default:'' }}">
        </div>
        <div class="col">
            <label for="enddate">Дата по:</label>
            <input type="date" id="enddate" name="enddate" class="form-control"
                   value="{{ request_params.enddate|default:'' }}">
        </div>
    </div>
    <button class="btn btn-primary btn-lg btn-block mt-3" type="submit">Шукати</button>
</form>


{% if error_message %}
<div class="alert alert-danger" role="alert">
    {{ error_message }}
</div>
{% endif %}

<form method="post" action="/csv">
    {% csrf_token %}
    <input type="text" id="fieldnames" name="fieldnames" value="{{ fieldnames }}" hidden/>
    <input type="text" id="csv_json" name="csv_json" value="{{ csv_response }}" hidden/>
    <button class="btn btn-primary btn-m btn-block mt-2" type="submit" {% if not csv_button %} hidden {% endif %}>
        Download .csv
    </button>
</form>
<div class="col">
    <script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-jsonview/1.2.3/jquery.jsonview.min.js"
            integrity="sha512-ff/E/8AEnLDXnTCyIa+l80evPRNH8q5XnPGY/NgBL645jzHL1ksmXonVMDt7e5D34Y4DTOv+P+9Rmo9jBSSyIg=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-jsonview/1.2.3/jquery.jsonview.min.css"
          integrity="sha512-aM9sVC1lVWwuuq38iKbFdk04uGgRyr7ERRnO990jReifKRrYGLugrpLCj27Bfejv6YnAFW2iN3sm6x/jbW7YBg=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <script>
                        {% comment %} var json = {"hey": "guy","anumber": 243,"anobject": {"whoa": "nuts","anarray": [1,2,"thr<h1>ee"], "more":"stuff"},"awesome": true,"bogus": false,"meaning": null, "japanese":"明日がある。", "link": "http://jsonview.com", "notLink": "http://jsonview.com is great"}; {% endcomment %}
                        var json = JSON.parse('{{ response_json | escapejs }}')

                        $(function() {
                            $("#json").JSONView(json);
                            // with options
                            $("#json-collasped").JSONView(json, { collapsed: true });
                        });



    </script>
    <div id="json"></div>
</div>

{% endblock %}

